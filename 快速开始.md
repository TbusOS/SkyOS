# SkyOS ARM32 快速开始指南

## 🚀 一分钟体验SkyOS

### 前置条件
确保您的系统是Linux (推荐Ubuntu 20.04+) 或者有WSL环境。

### 快速安装

```bash
# 1. 安装必要工具
sudo apt-get update
sudo apt-get install gcc-arm-none-eabi qemu-system-arm make git

# 2. 克隆项目 (如果还没有)
cd ~/
git clone <your-repo-url> SkyOS
cd SkyOS

# 3. 检查工具链
make check-toolchain

# 4. 编译运行
make all
make run
```

### 预期输出

如果一切正常，您将看到：

```
======================================
    SkyOS - ARM32 教学操作系统
======================================
版本: 0.1.0 (教学演示版)
架构: ARM Cortex-A15
编译时间: Dec 20 2024 15:30:45
--------------------------------------
处理器ID: 0x412FC0F1
当前模式: Supervisor (CPSR: 0x600001D3)
中断状态: IRQ禁用 FIQ禁用
--------------------------------------
内核初始化完成！
======================================

开始心跳显示 (按Ctrl+A X退出QEMU):
心跳 #0x00000000 - SkyOS 正在运行!
心跳 #0x00000001 - SkyOS 正在运行!
...
```

### 退出QEMU
按 `Ctrl+A` 然后按 `X` 键退出QEMU。

## 🛠️ 开发流程

### 1. 修改代码
```bash
# 编辑源文件
code kernel/main.c    # 或者使用您喜欢的编辑器
```

### 2. 重新编译
```bash
make clean   # 清理之前的编译
make all     # 重新编译
```

### 3. 测试运行
```bash
make run     # 在QEMU中运行
# 或者
make debug   # 调试模式运行
```

### 4. 调试技巧
```bash
# 终端1: 启动调试模式
make debug

# 终端2: 连接GDB调试
arm-none-eabi-gdb -ex 'target remote localhost:1234' build/skyos.elf

# 在GDB中的常用命令
(gdb) break main           # 在main函数设置断点
(gdb) continue             # 继续执行
(gdb) info registers       # 查看寄存器
(gdb) disassemble $pc      # 反汇编当前位置
(gdb) x/10x $sp           # 查看栈内容
```

## 📁 项目结构详解

```
SkyOS/
├── README.md                    # 项目介绍
├── Makefile                     # 构建脚本
├── 快速开始.md                  # 本文件
├── boot/                        # 启动代码
│   ├── start.S                  # ARM汇编启动代码
│   └── boot.lds                 # 链接脚本
├── kernel/                      # 内核源码
│   └── main.c                   # C语言主函数
├── docs/                        # 文档
│   ├── 教学实施计划-ARM32.md    # 详细教学计划
│   └── labs/                    # 实验指导
│       └── 实验01-ARM32启动.md  # 第一个实验
└── build/                       # 编译输出 (make后生成)
    ├── skyos.elf               # ELF可执行文件
    ├── skyos.bin               # 二进制镜像
    └── *.o                     # 目标文件
```

## 🎯 学习路径建议

### 第一周：熟悉环境
1. 阅读 `README.md` 了解项目概况
2. 完成环境搭建和第一次运行
3. 阅读 `docs/labs/实验01-ARM32启动.md`
4. 理解 `boot/start.S` 启动代码

### 第二周：深入理解
1. 分析 `kernel/main.c` 的功能
2. 修改输出信息，重新编译运行
3. 使用GDB调试，观察寄存器状态
4. 完成实验01的所有任务

### 后续学习
按照 `docs/教学实施计划-ARM32.md` 中的七个阶段循序渐进学习。

## 🐛 常见问题

### Q: make check-toolchain失败
**A**: 安装ARM工具链
```bash
sudo apt-get install gcc-arm-none-eabi qemu-system-arm
```

### Q: 编译时出现链接错误
**A**: 检查链接脚本和目标文件
```bash
make clean
make all
```

### Q: QEMU启动后没有输出
**A**: 检查UART配置，确保使用正确的machine类型
```bash
# Makefile中应该有
QEMU_FLAGS = -machine virt -cpu cortex-a15 -nographic
```

### Q: 如何添加新的源文件？
**A**: 
1. 在相应目录添加 `.c` 或 `.S` 文件
2. Makefile会自动检测并编译
3. 如果需要特殊处理，修改Makefile

### Q: 如何在真实硬件上运行？
**A**: 
1. 使用 `make sdcard` 生成SD卡镜像
2. 烧录到SD卡
3. 在ARM开发板上启动

## 📚 推荐学习资源

### 在线资源
- [ARM Architecture Reference Manual](https://developer.arm.com/documentation)
- [QEMU ARM System Emulation User Guide](https://qemu.readthedocs.io)
- [GCC ARM Embedded](https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm)

### 相关课程
- 操作系统原理
- 计算机体系结构  
- 嵌入式系统设计
- ARM汇编语言编程

## 💡 贡献与反馈

### 问题反馈
如果遇到问题或有改进建议：
1. 检查现有的Issues
2. 提交新的Issue，详细描述问题
3. 提供错误日志和环境信息

### 代码贡献
1. Fork本项目
2. 创建功能分支
3. 提交Pull Request
4. 参与代码Review

## 📞 获取帮助

- **技术问题**: 查看docs/目录下的文档
- **实验指导**: 参考docs/labs/目录
- **社区讨论**: 课程论坛或GitHub Discussions
- **紧急问题**: 联系教师或助教

---

祝您学习愉快！🎓 